<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ceying.chx.common.dao.SysUserLoginDao">
    <resultMap id="BaseResultMap" type="SysUserLoginDto">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="USER_ID" jdbcType="VARCHAR" property="userId" />
        <result column="TENANT_ID" jdbcType="INTEGER" property="tenantId" />
        <result column="LAST_LOGIN_DATE" jdbcType="TIMESTAMP" property="lastLoginDate" />
        <result column="LAST_LOGIN_IP" jdbcType="VARCHAR" property="lastLoginIp" />
        <result column="LOGIN_FAIL_TIMES" jdbcType="INTEGER" property="loginFailTimes" />
        <result column="LAST_FAIL_DATE" jdbcType="TIMESTAMP" property="lastFailDate" />
        <result column="EXT_FIELD" jdbcType="VARCHAR" property="extField" />
        <result column="ORG_ID" jdbcType="VARCHAR" property="orgId" />
        <result column="USER_NAME" jdbcType="VARCHAR" property="userName" />
        <result column="TENANT_CNSHORTNAME" jdbcType="VARCHAR" property="tenantCnshortname" />
        <result column="TENANT_SHORTNAME" jdbcType="VARCHAR" property="tenantShortname" />
        <result column="MOBILE" jdbcType="VARCHAR" property="mobile" />
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        USER_ID, TENANT_ID, LAST_LOGIN_DATE, LAST_LOGIN_IP, LOGIN_FAIL_TIMES, LAST_FAIL_DATE,
        EXT_FIELD, ORG_ID, USER_NAME, TENANT_CNSHORTNAME, TENANT_SHORTNAME, MOBILE
    </sql>
    <select id="selectByPrimaryKey"  resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Column_List" />
        from TSYS_USER_LOGIN
        where USER_ID = #{userId,jdbcType=VARCHAR} and TENANT_ID = #{tenantId}
    </select>
    <delete id="deleteByPrimaryKey"  >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from TSYS_USER_LOGIN
        where USER_ID = #{userId,jdbcType=VARCHAR} and TENANT_ID = #{tenantId}
    </delete>
    <insert id="insert" parameterType="SysUserLoginDto">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into TSYS_USER_LOGIN (USER_ID, TENANT_ID, LAST_LOGIN_DATE,
        LAST_LOGIN_IP, LOGIN_FAIL_TIMES, LAST_FAIL_DATE,
        EXT_FIELD, ORG_ID, USER_NAME,
        TENANT_CNSHORTNAME, TENANT_SHORTNAME, MOBILE
        )
        values (#{userId,jdbcType=VARCHAR}, #{tenantId,jdbcType=DECIMAL}, #{lastLoginDate,jdbcType=TIMESTAMP},
        #{lastLoginIp,jdbcType=VARCHAR}, #{loginFailTimes,jdbcType=DECIMAL}, #{lastFailDate,jdbcType=TIMESTAMP},
        #{extField,jdbcType=VARCHAR}, #{orgId,jdbcType=VARCHAR}, #{userName,jdbcType=VARCHAR},
        #{tenantCnshortname,jdbcType=VARCHAR}, #{tenantShortname,jdbcType=VARCHAR}, #{mobile,jdbcType=VARCHAR}
        )
    </insert>
    <insert id="insertSelective" parameterType="SysUserLoginDto">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into TSYS_USER_LOGIN
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="userId != null">
                USER_ID,
            </if>
            <if test="tenantId != null">
                TENANT_ID,
            </if>
            <if test="lastLoginDate != null">
                LAST_LOGIN_DATE,
            </if>
            <if test="lastLoginIp != null">
                LAST_LOGIN_IP,
            </if>
            <if test="loginFailTimes != null">
                LOGIN_FAIL_TIMES,
            </if>
            <if test="lastFailDate != null">
                LAST_FAIL_DATE,
            </if>
            <if test="extField != null">
                EXT_FIELD,
            </if>
            <if test="orgId != null">
                ORG_ID,
            </if>
            <if test="userName != null">
                USER_NAME,
            </if>
            <if test="tenantCnshortname != null">
                TENANT_CNSHORTNAME,
            </if>
            <if test="tenantShortname != null">
                TENANT_SHORTNAME,
            </if>
            <if test="mobile != null">
                MOBILE,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="userId != null">
                #{userId,jdbcType=VARCHAR},
            </if>
            <if test="tenantId != null">
                #{tenantId,jdbcType=DECIMAL},
            </if>
            <if test="lastLoginDate != null">
                #{lastLoginDate,jdbcType=TIMESTAMP},
            </if>
            <if test="lastLoginIp != null">
                #{lastLoginIp,jdbcType=VARCHAR},
            </if>
            <if test="loginFailTimes != null">
                #{loginFailTimes,jdbcType=DECIMAL},
            </if>
            <if test="lastFailDate != null">
                #{lastFailDate,jdbcType=TIMESTAMP},
            </if>
            <if test="extField != null">
                #{extField,jdbcType=VARCHAR},
            </if>
            <if test="orgId != null">
                #{orgId,jdbcType=VARCHAR},
            </if>
            <if test="userName != null">
                #{userName,jdbcType=VARCHAR},
            </if>
            <if test="tenantCnshortname != null">
                #{tenantCnshortname,jdbcType=VARCHAR},
            </if>
            <if test="tenantShortname != null">
                #{tenantShortname,jdbcType=VARCHAR},
            </if>
            <if test="mobile != null">
                #{mobile,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="SysUserLoginDto">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update TSYS_USER_LOGIN
        <set>
            <if test="tenantId != null">
                TENANT_ID = #{tenantId,jdbcType=DECIMAL},
            </if>
            <if test="lastLoginDate != null">
                LAST_LOGIN_DATE = #{lastLoginDate,jdbcType=TIMESTAMP},
            </if>
            <if test="lastLoginIp != null">
                LAST_LOGIN_IP = #{lastLoginIp,jdbcType=VARCHAR},
            </if>
            <if test="loginFailTimes != null">
                LOGIN_FAIL_TIMES = #{loginFailTimes,jdbcType=DECIMAL},
            </if>
            <if test="lastFailDate != null">
                LAST_FAIL_DATE = #{lastFailDate,jdbcType=TIMESTAMP},
            </if>
            <if test="extField != null">
                EXT_FIELD = #{extField,jdbcType=VARCHAR},
            </if>
            <if test="orgId != null">
                ORG_ID = #{orgId,jdbcType=VARCHAR},
            </if>
            <if test="userName != null">
                USER_NAME = #{userName,jdbcType=VARCHAR},
            </if>
            <if test="tenantCnshortname != null">
                TENANT_CNSHORTNAME = #{tenantCnshortname,jdbcType=VARCHAR},
            </if>
            <if test="tenantShortname != null">
                TENANT_SHORTNAME = #{tenantShortname,jdbcType=VARCHAR},
            </if>
            <if test="mobile != null">
                MOBILE = #{mobile,jdbcType=VARCHAR},
            </if>
        </set>
        where USER_ID = #{userId,jdbcType=VARCHAR} and TENANT_ID = #{tenantId}
    </update>
    <update id="updateByPrimaryKey" parameterType="SysUserLoginDto">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update TSYS_USER_LOGIN
        set TENANT_ID = #{tenantId,jdbcType=DECIMAL},
        LAST_LOGIN_DATE = #{lastLoginDate,jdbcType=TIMESTAMP},
        LAST_LOGIN_IP = #{lastLoginIp,jdbcType=VARCHAR},
        LOGIN_FAIL_TIMES = #{loginFailTimes,jdbcType=DECIMAL},
        LAST_FAIL_DATE = #{lastFailDate,jdbcType=TIMESTAMP},
        EXT_FIELD = #{extField,jdbcType=VARCHAR},
        ORG_ID = #{orgId,jdbcType=VARCHAR},
        USER_NAME = #{userName,jdbcType=VARCHAR},
        TENANT_CNSHORTNAME = #{tenantCnshortname,jdbcType=VARCHAR},
        TENANT_SHORTNAME = #{tenantShortname,jdbcType=VARCHAR},
        MOBILE = #{mobile,jdbcType=VARCHAR}
        where USER_ID = #{userId,jdbcType=VARCHAR} and TENANT_ID = #{tenantId}
    </update>

    <select id="queryAll" resultMap="BaseResultMap">
 		select * from
         ( select g.*,rownum rn from
         	(select * from TSYS_USER_LOGIN
         	 where 1=1
         	 <if test="userId !=null and userId !=''">
            	and USER_ID = #{userId}
        	 </if>
            <if test="userName !=null and userName !=''">
                and USER_NAME=#{userName}
            </if>
	         <if test="tenantId !=null and tenantId !=''">
	            and TENANT_ID = #{tenantId}
	         </if>
	         <if test="orgId !=null and orgId !=''">
	            and ORG_ID = #{orgId}
	         </if>
         	 ) g
         	where 1=1 and rownum <![CDATA[ <= ]]> #{rows} * #{page}
          )
         where rn <![CDATA[>]]> (#{page} - 1) * #{rows}
         order by OPENEDDATE desc
    </select>

    <select id="countTotal" resultType="java.lang.Integer">
        select count(*) from TSYS_USER_LOGIN
        where 1=1
        <if test="userId !=null and userId !=''">
            	and USER_ID = #{userId}
        	 </if>
        <if test="tenantId !=null and tenantId !=''">
            and TENANT_ID = #{tenantId}
        </if>
        <if test="orgId !=null and orgId !=''">
            and ORG_ID = #{orgId}
        </if>
    </select>
</mapper>